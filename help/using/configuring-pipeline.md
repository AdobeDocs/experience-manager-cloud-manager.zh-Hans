---
title: 配置CI/CD管线
seo-title: 配置CI/CD管线
description: 请按照本页配置Cloud Manager的渠道设置。
seo-description: '在开始部署代码之前，您必须从AEM Cloud Manager配置管道设置。 '
uuid: 35fd56ac-dc9 c-4aca-6ac-36c29 c4 ec497
contentOwner: jsyal
products: SG_ EXPERIENCE MANAGER/CLEDNAGNANAGER
topic-tags: using
content-type: 引用
discoiquuid: ba6c763a-b78 a-439e-8c40-367203a719 b3
translation-type: tm+mt
source-git-commit: 862501f28f5104d0829a6d2d2ad5f5ce9f8ba341

---


# 配置CI/CD管线 {#configure-your-ci-cd-pipeline}

下表介绍了如何配置 **渠道**。查看有关该渠道如何使用 [CI/CD管线概述的更多概念信息](ci-cd-pipeline.md)。

## 了解流程 {#understanding-the-flow}

您可以从UI **的渠道设置** 拼贴中配置管道 [!UICONTROL Cloud Manager] 。

部署经理负责设置渠道。这样做时，您首先从 **Git存储库中选择一个分支**。管道配置包括：

* 定义将启动管道的触发器。
* 定义控制生产部署的参数。
* 配置性能测试参数。

## 设置渠道 {#setting-up-the-pipeline}

>[!CAUTION]
>
>只有在Git存储库至少有一个分支和 [计划设置](setting-up-program.md) 完成之前，才能设置该渠道。

在开始部署代码之前，必须先配置您的渠道设置 [!UICONTROL Cloud Manager]。

>[!NOTE]
>
>您可以在初始设置后更改管道设置。

### 配置渠道设置(从 [!UICONTROL Cloud Manager]{#configuring-the-pipeline-settings-from-cloud-manager}

使用 [!UICONTROL Cloud Manager] UI设置程序后，即可设置管道。

请按照以下步骤配置渠道的行为和首选项：

1. 单击 **设置管道** 以设置和配置您的管道。

   ![](assets/Configure_ci-cd-1.png)

1. 此时会显示 **“设置管道** ”屏幕。

   通过三步向导，您可以设置 **分支**、 **环境**&#x200B;和 **测试** 环境。
选择您的Git分支，然后单击 **下**&#x200B;一步。

   >[!NOTE]
   >
   >Git存储库中的分支会链接到您的程序。

   ![](assets/Configure_ci-cd-2.png)


1. 访问 **“环境** ”选项卡以选择 **“舞台** 和 **生产** ”选项。

   您可以定义触发器以启动管道：

   * **在Git更改** 上-每当已将已配置的git分支添加到CI/CD管线时，启动CI/CD管线。即使您选择此选项，始终可以手动启动管道。
   * **手动** -使用UI手动启动管道。
   * **计划** -此选项即将在即将发布的版本中推出。
   在管道设置或编辑过程中，部署管理器可以选择在任何质量门(如代码质量、安全测试和性能测试)中遇到重要故障时定义渠道行为。

   这对于希望实现更自动化流程的客户很有用。可用的选项有：

* **每次询问** -这是默认设置，并且需要手动干预任何重要故障。
* **立即失败** -如果已选择，则在发生重要故障时，将取消渠道。这实质上模拟用户手动拒绝每个失败的用户。
* **立即继续** -如果选择，则在发生重要故障时，管道会自动继续。这实际上是模拟用户手动批准每个失败。

   现在，您可以定义控制生产部署的参数。以下三个可用选项如下所示：

* **使用开始实时批准** -部署必须由业务所有者、项目经理或部署经理通过 [!UICONTROL Cloud Manager] UI手动批准。
* **使用CSE监控** - CSE会参与实际开始部署。在启用CSE监控的过程中，在管道设置或编辑过程中，部署管理器可以选择以下选项：

   * **任何CSE**：引用任何可用的CSE
   * **我的CSE**：指分配给客户或其备份的特定CSE(如果CSE不在办公室之外)

* **计划** -此选项允许用户启用计划的生产部署。

>[!NOTE]
>
>如果选择 **了“计划** ”选项，您可以在舞台部署 **之后** 将生产部署计划到渠道(如果 **已启用，则使用GoLive Approval**)等待设置计划。用户还可以选择立即执行生产部署。
>
>请参阅 [**部署代码**](deploying-code.md)，以设置部署计划或立即执行生产。

![](assets/Configure_ci-cd-3.png)

>[!NOTE]
>
>“ **使用CSE监控** ”选项不适用于所有客户。

**调度程序失效**

作为部署管理器，您有机会配置一组路径，这些路径将 **在设置或编辑管道时从AEM调度程序缓存失效** 或 **刷新** 。

您可以为舞台和生产部署配置单独的一组路径。如果配置此配置，则这些缓存操作将作为部署管道步骤的一部分执行，紧接部署任何内容包后。这些设置使用标准AEM调度程序行为-无效执行缓存失效，类似于将内容从作者激活到发布时；刷新执行缓存删除。

通常，使用失效操作更好，但有时需要刷新，特别是在使用AEM HTML客户端库时。

>[!NOTE]
>
>请参阅 [调度程序概述](dispatcher-configurations.md) 获取有关Dispatcher缓存的更多信息。

请按照以下步骤配置调度程序失效说明：

1. 单击 **“调度程序配置”标题** 下的配置

   ![](assets/image2018-8-7_14-53-24.png)

1. 输入路径，从 **类型**&#x200B;中选择操作，然后单击 **添加**。每个环境最多可指定100个路径。添加路径后，单击 **“应用**”。

   ![](assets/image2018-8-7_14-58-11.png)

1. 回到 **“渠道设置** ”页面后，您将看到一个更新的摘要摘要。

   单击 **保存** 以保留此配置。

   ![](assets/image2018-8-7_15-4-30.png)

1. 访问 **“测试** ”选项卡以定义您的程序的测试条件。

   现在，您可以配置性能测试参数。

   根据您获得许可的产品，您可以配置 *AEM Sites* 和 *AEM资产* 性能测试。

   **AEM Sites:**

   Cloud Manager通过在舞台发布服务器上请求页面(即未验证的用户)，在30分钟的测试期内对其执行性能测试，并测量每个页面的响应时间以及各种系统级指标。页面由三个 **页面集选择**；您可以从一个位置到所有三个集进行选择。流量的分布取决于选定的集合数量，即如果全部被选中，则将页面查看总次数的33%放入每个集合；如果选择两项，则50%转至每组；如果选择一个，则100%流量转到该设置。

   例如，假设在“常用的实时页面”和“新建页面”之间有50%/50%的分割(本示例中未使用其他实时页面)，而新页面集包含3000页。每分钟KPI的页面查看次数设置为200。在30分钟的测试期内：

   * “常用实时页面”集中的25个页面将点击240次-(((200*0.5)/25)*30=120

   * “新建页面”集中的3000页将被点击一次-(((200*0.5)/)3000)*30=1
   ![](assets/Configuring_Pipeline_AEM-Sites.png)

   **AEM Assets:**

   Cloud Manager可通过重复上传30分钟测试期并测量各个资产的处理时间以及各种系统级指标，执行AEM Assets程序的性能测试。此功能可上传图像和PDF文档。在“管道设置”或“编辑”屏幕中设置每分钟上传的资产资源的数量。

   例如，如果使用70/30拆分，如下图所示。每分钟上传10个资产，图像将上传每分钟和个文档。

   ![](assets/Configuring_Pipeline_AEM-Assets.png)

   >[!NOTE]
   >
   >有默认的图像和PDF文档，但在大多数情况下，客户将希望上传自己的资产。可通过“管道设置”或“编辑”屏幕完成此操作。Photoshop、Illustrator和Postscript文件支持通用图像格式，如JPEG、PNG、GIF和BMP。

1. 单击 **保存** 以完成管道流程的设置。

   >[!NOTE]
   >
   >此外，您还可以在设置渠道后使用UI中 **的“生产管道设置** ”拼贴编辑相同的设置 [!UICONTROL Cloud Manager] 。

   ![](assets/Prod-Pipeline-Settings-Dialog.png)

## 非生产和代码质量渠道

除了部署到舞台和生产的主管道之外，客户还可以建立其他管道，称为 **非生产管道**。这些管道始终执行构建和代码质量步骤。他们还可以选择部署到Adobe Managed Services环境。

在主屏幕上，这些管道在新信息卡中列出：

1. 从Cloud Manager主页屏幕访问 **非生产渠道** 拼贴。

   ![](assets/Configuring_Pipeline_Add-Production.png)

1. 单击“添加”按钮，指定渠道名称、管道类型和Git分支。

   此外，还可以从管道选项中设置部署触发器和重要故障行为。

   ![](assets/Configuring_Pipeline_Add-Production2.png)

1. 单击 **保存，** 此时主屏幕上的卡片上会显示三个操作：

   * **编辑** -允许编辑管道设置
   * **详细信息** -显示上次管道执行(如果存在)
   * **构建** -导航到执行页面，可从中执行管道
   ![](assets/Configuring_Pipeline_Add-Production3.png)

   >[!NOTE]
   >
   >在渠道运行时，将显示当前步骤，并且仅提供 **Details** 操作。

## 后续步骤 {#the-next-steps}

配置渠道后，您需要部署代码。

有关更多详细信息，请参阅 [部署代码](deploying-code.md) 。
